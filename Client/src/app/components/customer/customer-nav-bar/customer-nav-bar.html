<nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom sticky-top shadow-sm">
  <div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center w-100">
      <a [routerLink]="['/home']" class="d-flex align-items-center gap-2 text-decoration-none">
        <!-- <img src="./favicon.png" width="48" height="48" alt="Salahly logo" /> -->
        <img [src]="logoSrc"  height="50" alt="Salahly logo" />
        <!-- <span class="text-secondary fs-3 fst-italic">{{ 'BlankNavBar.Salahly' | translate }}</span> -->
      </a>

      <div class="d-none d-md-flex align-items-center gap-4">
        <!-- NOTIFICATION BELL -->
<div class="notification-wrapper position-relative me-3">
  <button class="btn p-0 border-0 bg-transparent" (click)="toggleNotifications()">
    <i class="fa-regular fa-bell fs-4"></i>

    @if(unread > 0){
      <span class="notification-dot"></span>
    }
  </button>

  @if(showNotifications){
    <div class="notification-dropdown shadow-sm">
      @for(n of notifications; track n.notificationId){
        <div class="notification-item"
     [ngClass]="{
       'unread': !n.isRead,
       'type-request': n.type == 1,
       'type-offer': n.type == 2,
       'type-accepted': n.type == 3,
       'type-rejected': n.type == 4,
       'type-booking': n.type >= 5 && n.type <= 7,
       'type-review': n.type == 8,
       'type-payment': n.type == 9
     }"
     (click)="openNotification(n)">


          <p class="m-0 fw-semibold">{{ n.title }}</p>
          <small class="text-muted">{{ n.message }}</small>
        </div>
      }

      @if(notifications.length === 0){
        <p class="text-center text-muted m-2">No notifications</p>
      }
    </div>
  }
</div>
        <!-- END NOTIFICATION BELL -->

        <a routerLink="/home" routerLinkActive="active" class="d-flex align-items-center gap-2 text-secondary nav-link">
          <i class="fa-regular fa-house"></i>
          <span>{{ 'BlankNavBar.Home' | translate }}</span>
        </a>

        <a routerLink="/browse" routerLinkActive="active" class="d-flex align-items-center gap-2 text-secondary nav-link">
          <i class="fa-solid fa-magnifying-glass"></i>
          <span>{{ 'BlankNavBar.Browse Technicians' | translate }}</span>
        </a>

        <app-translate-select [color]="'black'"></app-translate-select>

        <div class="position-relative">
          <button class="btn p-0 border-0 bg-transparent" (click)="toggleUserMenu($event)">
            @if(user.imageUrl){
              <img [src]="user.imageUrl" alt="Avatar" class="avatar-image" />
            }@else{
              <div class="avatar-circle">{{ userInitials }}</div>
            }
          </button>

          @if(userMenuOpen){
            <div class="user-dropdown shadow-sm">
              <button class="dropdown-item" (click)="navigate('/customer-profile')">
                <i class="fa-regular fa-user"></i>
                <span>{{ 'CustomerNav.Profile' | translate }}</span>
              </button>
              <button class="dropdown-item" (click)="navigate('/show-services-requested')">
                <i class="fa-solid fa-list-check"></i>
                <span>{{ 'CustomerNav.Requests' | translate }}</span>
              </button>
              <button class="dropdown-item text-danger" (click)="logout()">
                <i class="fa-solid fa-arrow-right-from-bracket"></i>
                <span>{{ 'CustomerNav.Logout' | translate }}</span>
              </button>
            </div>
          }
        </div>
      </div>

      <button class="navbar-toggler d-md-none border-0" type="button" (click)="toggleMenu()" aria-label="Toggle navigation">
        <i [class]="mobileMenuOpen ? 'fa-solid fa-xmark fs-3' : 'fa-solid fa-bars fs-3'"></i>
      </button>
    </div>
  </div>

  @if(mobileMenuOpen){
    <div class="d-md-none border-top bg-white w-100">
      <div class="px-4 py-4">
        <div class="d-flex align-items-center gap-3 mb-3">
          <div class="avatar-circle">
            @if(user.imageUrl){
              <img [src]="user.imageUrl" alt="Avatar" class="avatar-image" />
            }@else{
              <div class="avatar-circle">{{ userInitials }}</div>
            }
          </div>
          <div>
            <p class="fw-semibold mb-0">{{ user.name }}</p>
            <small class="text-muted">{{ 'CustomerNav.CustomerLabel' | translate }}</small>
          </div>
        </div>

        <a routerLink="/home" (click)="closeMobileMenu()" class="d-flex align-items-center gap-2 text-secondary nav-link py-2">
          <i class="fa-regular fa-house"></i>
          <span>{{ 'BlankNavBar.Home' | translate }}</span>
        </a>

        <a routerLink="/browse" (click)="closeMobileMenu()" class="d-flex align-items-center gap-2 text-secondary nav-link py-2">
          <i class="fa-solid fa-magnifying-glass"></i>
          <span>{{ 'BlankNavBar.Browse Technicians' | translate }}</span>
        </a>

        <div class="pt-3 border-top mt-3">
          <button class="btn btn-light w-100 text-start d-flex align-items-center gap-2 mb-2" (click)="navigate('/customer-profile')">
            <i class="fa-regular fa-user"></i>
            <span>{{ 'CustomerNav.Profile' | translate }}</span>
          </button>
          <button class="btn btn-light w-100 text-start d-flex align-items-center gap-2 mb-2" (click)="navigateToRequests()">
            <i class="fa-solid fa-list-check"></i>
            <span>{{ 'CustomerNav.Requests' | translate }}</span>
          </button>
          <button class="btn btn-outline-danger w-100 d-flex align-items-center gap-2" (click)="logout()">
            <i class="fa-solid fa-arrow-right-from-bracket"></i>
            <span>{{ 'CustomerNav.Logout' | translate }}</span>
          </button>
        </div>

        <div class="pt-3">
          <app-translate-select [color]="'black'"></app-translate-select>
        </div>
      </div>
    </div>
  }
</nav>
