<div class="min-vh-100 d-flex align-items-center justify-content-center bg-light py-5 px-3">
  <div class="card w-100" style="max-width: 30rem;">
    <div class="card-header text-center bg-white border-0 mt-2">
      <h2 class="card-title">{{"Signup.Create Account" | translate}}</h2>
      <p class="card-text">
        {{  "Signup.Choose your account type to get started" | translate }}
      </p>
    </div>

    <div class="card-body">
      <!-- Tabs -->
      <div class="btn-group d-flex justify-content-center gap-2 mb-3 tab" role="group" >
        <button type="button" class="btn rounded-end-4 tab" (click)="activeTab = 'customer'" [class.active]="activeTab === 'customer'">{{"Login.Customer" | translate}}</button>
        <button type="button" class="btn rounded-end-4 tab" (click)="activeTab = 'craftsman'" [class.active]="activeTab === 'craftsman'">{{"Login.Technician" | translate}}</button>
      </div>
      
      <!-- Customer Registration Form -->
      @if(activeTab === 'customer') {
        <form [formGroup]="customerForm" (ngSubmit)="onSubmit()">
          <div class="mb-3">
            <label class="form-label">{{ 'Signup.Full Name' | translate }}</label>
            <input type="text" class="form-control" formControlName="fullName" [placeholder]="'Signup.Enter your full name' | translate" />
            @if(customerForm.get('fullName')?.invalid && customerForm.get('fullName')?.touched) {
              <small class="text-danger">{{ 'Signup.Full name is required' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Login.Email' | translate }}</label>
            <input type="email" class="form-control" formControlName="email" placeholder="sarah@example.com" />
            @if(customerForm.get('email')?.invalid && customerForm.get('email')?.touched) {
              <small class="text-danger">{{ 'Signup.Valid email is required' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Login.Password' | translate }}</label>
            <input type="password" class="form-control" formControlName="password" />
            @if(customerForm.get('password')?.invalid && customerForm.get('password')?.touched) {
              <small class="text-danger">{{ 'Signup.Password must be at least 6 characters' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Signup.Phone Number' | translate }}</label>
            <input class="form-control" formControlName="phoneNumber" [placeholder]="'Signup.Enter 11 digit phone number' | translate" />
            @if(customerForm.get('phoneNumber')?.invalid && customerForm.get('phoneNumber')?.touched) {
              <small class="text-danger">{{ 'Signup.Enter a valid 11-digit Egyptian phone number.' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Signup.Date of Birth' | translate }}</label>
            <input type="date" class="form-control" formControlName="dateOfBirth" />
            @if(customerForm.get('dateOfBirth')?.invalid && customerForm.get('dateOfBirth')?.touched) {
              <small class="text-danger">{{ 'Signup.Date of birth is required' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Signup.City' | translate }}</label>
            <input type="text" class="form-control" formControlName="city" [placeholder]="'Signup.Enter your city' | translate" />
            @if(customerForm.get('city')?.invalid && customerForm.get('city')?.touched) {
              <small class="text-danger">{{ 'Signup.City is required' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Signup.Area' | translate }}</label>
            <input type="text" class="form-control" formControlName="area" [placeholder]="'Signup.Enter your area' | translate" />
            @if(customerForm.get('area')?.invalid && customerForm.get('area')?.touched) {
              <small class="text-danger">{{ 'Signup.Area is required' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Signup.Address' | translate }}</label>
            <textarea class="form-control" formControlName="address" rows="2" [placeholder]="'Signup.Enter your full address' | translate"></textarea>
            @if(customerForm.get('address')?.invalid && customerForm.get('address')?.touched) {
              <small class="text-danger">{{ 'Signup.Address is required' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Signup.Profile Image URL' | translate }} ({{ 'Signup.Optional' | translate }})</label>
            <input type="url" class="form-control" formControlName="profileImageUrl" [placeholder]="'Signup.Enter image URL' | translate" />
          </div>

          <button class="btn signupBtn w-100" type="submit">
            {{ "Signup.Signup as Customer" | translate }}
          </button>
        </form>
      }

      <!-- Craftsman Registration Form -->
      @if(activeTab === 'craftsman') {
        <form [formGroup]="craftsmanForm" (ngSubmit)="onSubmit()">
          <div class="mb-3">
            <label class="form-label">{{ 'Signup.Full Name' | translate }}</label>
            <input type="text" class="form-control" formControlName="fullName" [placeholder]="'Signup.Enter your full name' | translate" />
            @if(craftsmanForm.get('fullName')?.invalid && craftsmanForm.get('fullName')?.touched) {
              <small class="text-danger">{{ 'Signup.Full name is required' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Login.Email' | translate }}</label>
            <input type="email" class="form-control" formControlName="email" placeholder="john@example.com" />
            @if(craftsmanForm.get('email')?.invalid && craftsmanForm.get('email')?.touched) {
              <small class="text-danger">{{ 'Signup.Valid email is required' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Login.Password' | translate }}</label>
            <input type="password" class="form-control" formControlName="password" />
            @if(craftsmanForm.get('password')?.invalid && craftsmanForm.get('password')?.touched) {
              <small class="text-danger">{{ 'Signup.Password must be at least 6 characters' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Signup.Bio' | translate }}</label>
            <textarea class="form-control" formControlName="bio" rows="3" [placeholder]="'Signup.Tell us about your experience and skills' | translate"></textarea>
            @if(craftsmanForm.get('bio')?.invalid && craftsmanForm.get('bio')?.touched) {
              <small class="text-danger">{{ 'Signup.Bio is required' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Signup.Years of Experience' | translate }}</label>
            <input type="number" class="form-control" formControlName="yearsOfExperience" min="0" [placeholder]="'Signup.Enter years of experience' | translate" />
            @if(craftsmanForm.get('yearsOfExperience')?.invalid && craftsmanForm.get('yearsOfExperience')?.touched) {
              <small class="text-danger">{{ 'Signup.Years of experience is required' | translate }}</small>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">{{ 'Signup.Profile Image URL' | translate }} ({{ 'Signup.Optional' | translate }})</label>
            <input type="url" class="form-control" formControlName="profileImageUrl" [placeholder]="'Signup.Enter image URL' | translate" />
          </div>

          <!-- Serve Areas -->
          <div class="mb-3">
            <label class="form-label">{{ 'Signup.Service Areas' | translate }}</label>
            <div formArrayName="serveAreas">
              @for(area of serveAreas.controls; track $index) {
                <div [formGroupName]="$index" class="border rounded p-3 mb-2">
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <strong>{{ 'Signup.Area' | translate }} {{$index + 1}}</strong>
                    @if(serveAreas.controls.length > 1) {
                      <button type="button" class="btn btn-sm btn-danger" (click)="removeServeArea($index)">
                        {{ 'Signup.Remove' | translate }}
                      </button>
                    }
                  </div>
                  <div class="row">
                    <div class="col-md-6 mb-2">
                      <label class="form-label">{{ 'Signup.City' | translate }}</label>
                      <input type="text" class="form-control" formControlName="city" [placeholder]="'Signup.Enter city' | translate" />
                      @if(area.get('city')?.invalid && area.get('city')?.touched) {
                        <small class="text-danger">{{ 'Signup.City is required' | translate }}</small>
                      }
                    </div>
                    <div class="col-md-6 mb-2">
                      <label class="form-label">{{ 'Signup.Area' | translate }}</label>
                      <input type="text" class="form-control" formControlName="area" [placeholder]="'Signup.Enter area' | translate" />
                      @if(area.get('area')?.invalid && area.get('area')?.touched) {
                        <small class="text-danger">{{ 'Signup.Area is required' | translate }}</small>
                      }
                    </div>
                  </div>
                </div>
              }
            </div>
            <button type="button" class="btn btn-outline-secondary btn-sm w-100" (click)="addServeArea()">
              + {{ 'Signup.Add Another Service Area' | translate }}
            </button>
          </div>

          <button class="btn signupBtn w-100" type="submit">
            {{ "Signup.Signup as Technician" | translate }}
          </button>
          <div class="small text-muted mt-2 text-center">
            <span class="me-1">{{ "Signup.Your account will be reviewed before activation" | translate }}</span>
          </div>
        </form>
      }

      <div class="small text-muted mt-2 text-center">
        <span class="me-1">{{ "Signup.Already have an account?" | translate }}</span>
        <button class="btn btn-link p-0" [routerLink]= "['/login']">
          {{ "Signup.login" | translate }}
        </button>
      </div>
  </div>
</div>